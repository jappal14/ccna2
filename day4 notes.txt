task 2
hacking of the phone system of corrupt: congress/senate

config t
monitor session 1 source int fa0/3,fa0/5,fa0/7
monitor session 1 destination int fa 0/1
end



cmd

execute attack on port 139:
net use x: /delete
net use \\10.92.1.10\ipc$

persistence: command completed

privilege escalation:
net use x: \\10.92.1.10\c$

x:
mkdir PUMASOKAKOSALIKOD-urNAME


/delete



MXTOOLBOX
VIRUSTOTAL

block pornsite
config t
NO ip access-list standard NOPORN
ip access-list standard NOPORN
DENY 66.254.0.0 0.0.255.255
deny 161.49.0.0 0.0.255.255
DENY 104.21.0.0 0.0.255.255
DENY 68.235.0.0 0.0.255.255
DENY 104.17.0.0 0.0.255.255
DENY 88.208.0.0 0.0.255.255
DENY 208.77.0.0 0.0.255.255
DENY 172.67.0.0 0.0.255.255
DENY 45.60.0.0 0.0.255.255 - dpwh
Permit Any
Int Gi 1
 ip access-group NOPORN in
end

whitelist
config t
NO ip access-list standard NOPORN
ip access-list standard NOPORN
DENY 66.254.0.0 0.0.255.255
deny 161.49.0.0 0.0.255.255
DENY 104.21.0.0 0.0.255.255
DENY 68.235.0.0 0.0.255.255
DENY 104.17.0.0 0.0.255.255
DENY 88.208.0.0 0.0.255.255
DENY 208.77.0.0 0.0.255.255
DENY 172.67.0.0 0.0.255.255
Permit Any
Int Gi 1
 ip access-group NOPORN in
end


Goberno: allow all Porn, for freedom of expression!
config t
Int gi 1
 NO ip access-group NOPORN in
end

!@VERSION 2 APPROACH (OLD CISCO)
config t
no access-list 25
access-list 25 DENY 66.254.0.0 0.0.255.255
access-list 25 DENY 104.21.0.0 0.0.255.255
access-list 25 DENY 68.235.0.0 0.0.255.255
access-list 25 DENY 104.17.0.0 0.0.255.255
access-list 25 DENY 88.208.0.0 0.0.255.255
access-list 25 DENY 208.77.0.0 0.0.255.255
access-list 25 DENY 172.67.0.0 0.0.255.255
access-list 25 permit Any
Int gi 1
 ip access-group 25 in
end





block school portal
config t
NO ip access-list standard cutclass
ip access-list standard cutclass
DENY 172.67.0.0 0.0.255.255
DENY 50.6.0.0 0.0.255.255
DENY 184.168.0.0 0.0.255.255
DENY 155.137.0.0 0.0.255.255
DENY 136.158.0.0 0.0.255.255 - batstateu
Permit Any
Int Gi 1
 ip access-group cutclass in
end

remove the list
Int Gi 1
no ip access-group cutclass in
end




ex.1: you are the Blue Team/SOC guys for pogo sites:
ebet10.com open only http, https, ping:  80, 443, icmp
ebet11.com open only dns, https, ssh     53, 443, 22 ==> 6 lines:
  GOLDEN  FIREWALL FORMULA:  paloalto,fortinet,cisco,checkpoint.

!!protocol: voice-udp,tcp-date,icmp-ip
 hacker victim port

config t
no ip access-list extended fpn1
ip access-list extended fpn1
permit tcp any host bet10.com eq 80
permit tcp any host bet10.com eq 443
permit icmp any host bet10.com
permit tcp any host bet11.com eq 53
permit tcp any host bet11.com eq 443
permit tcp any host bet11.com eq 22
int gi 3
ip access-group fpn1 in
end

release the policy
config t
int gi 3
no ip access-group fpn1 in
end



task2: create policy2 where
bet10.com allows/permits https:443,ssh:22
bet11.com allows sccp:2000, sip:5060, h323:172
config t
no ip access-list extended POLICY2
ip access-list extended POLICY2
permit tcp any host bet10.com eq 443
permit tcp any host bet10.com eq 22
permit tcp any host bet10.com eq 2000
permit tcp any host bet11.com eq 5060
permit tcp any host bet10.com eq 1720
int gi 3
ip access-group POLICY2 in
end

task3: create policy3 where
bet10.com allows/permits https:443,ssh:22
bet11.com allows sccp:2000, sip:443, dns:53

config t
no ip access-list extended POLICY3
ip access-list extended POLICY3
permit tcp any host bet10.com eq 443
permit tcp any host bet10.com eq 22
permit tcp any host bet11.com eq 443
permit tcp any host bet11.com eq 53
int gi 3
ip access-group POLICY3 in
end





Config t
ip host ebet10.com 192.168.103.10
ip host ebet11.com 192.168.103.11
service timestamps log datetime
service timestamps debug datetime
logging 10.m.1.10
logging trap 5
!!How to Sumbong to SPLUNK LOGS
NO IP access-list Extended NGFW1
IP access-list Extended NGFW1
 Permit tcp Any host ebet10.com eq 80 log
 Permit tcp Any host ebet10.com eq 443 log
 Permit icmp Any host ebet10.com log
 Permit tcp Any host ebet11.com eq 53 log
 Permit tcp Any host ebet11.com eq 443 log
 Permit tcp Any host ebet11.com eq 22 log
 Int Gi 3
  ip access-group NGFW1 in
REMOVE FIREWALL:
CONfig t
 Int Gi 3
  NO ip access-group NGFW1 in
end




LINUX (21-22)

config t
no access-list 8
access-list 8 permit 192.168.103.21
access-list 8 permit 192.168.103.22
Int Gi 3
 ip nat Inside
Int gi 1
 ip nat Outside
IP Nat inside source static tcp 192.168.103.21 80 208.8.8.69 80
IP Nat inside source static tcp 192.168.103.21 443 208.8.8.69 443
IP Nat inside source static tcp 192.168.103.22 80 208.8.8.69 8080
IP Nat inside source static tcp 192.168.103.22 443 208.8.8.69 8443
IP nat inside source list 8 int gi 1 Overload
end
show ip nat translation




PYTHON
#!/usr/bin/env python
import cli

cmd1 = [
    "show ip int brief",
]

for k in cmd1:
    cli.executep(k)


#!/usr/bin/env python
import cli

rob_cm = '''hostname CSRPYTHON
'''

cli.configurep(rob_cm)

ex.5: Create 4 loopbacks:
import cli

cmd1 = '''hostname NETDEVOPS
int loop 4
ip add 4.4.4.4 255.255.255.255
int loop 5
ip add 5.5.5.5 255.255.255.255
int loop 6
ip add 6.6.6.6 255.255.255.255
end
'''
cli.configurep(cmd1)

